#---------------------------------------------------------------------------------------------------
#
#	By Karol Grzybowski, 2017
#
#---------------------------------------------------------------------------------------------------

#---------------------------------------------------------------------------------------------------
#
# Base paths.
#
#---------------------------------------------------------------------------------------------------

global.path.base	= $(BASE_DIRECTORY)
global.path.make	= $(global.path.base)/make
global.path.build	= $(global.path.base)/build

#---------------------------------------------------------------------------------------------------
#
# Common defintions.
#
#---------------------------------------------------------------------------------------------------

empty			:=
space			:= $(empty) $(empty)
comma			:= ,
colon			:= :

#---------------------------------------------------------------------------------------------------
#
# Host specific tools.
#
#---------------------------------------------------------------------------------------------------

host.path		= $(1)
host.rm			= rm -f $(1)
host.rmdir		= rm -rf $(1)
host.mkdir		= mkdir -p $(1)
host.ln			= ln -s $(1) $(2)
host.cp			= cp -f $(1) $(2)
host.mv			= mv -f $(1) $(2)
host.install		= cp -f $(1) $(2)
host.echo		= echo -e
host.sha512sum		= sha512sum

#---------------------------------------------------------------------------------------------------
#
# Makefile base tools.
#
#---------------------------------------------------------------------------------------------------
parent-dir		= $(patsubst %/,%,$(dir $(1:%/=%)))
make-dir		= if [ ! -d $(1) ]; then mkdir -p $(dir $(1)); fi
link-dir		= if [ ! -d $(1) ]; then ln $(1) $(2); fi
current-dir		= $(call parent-dir,$(lastword $(MAKEFILE_LIST)))
current-makefile	= $(lastword $(MAKEFILE_LIST))

#---------------------------------------------------------------------------------------------------
#
# Host and build system information.
#
#---------------------------------------------------------------------------------------------------

host.get-username	= $(shell whoami)
host.get-hostname	= $(shell hostname)
host.timestamp		= $(shell /bin/date "+%Y-%m-%dT%H:%M:%S")

#---------------------------------------------------------------------------------------------------
#
# DVCS commands for getting repository metadata.
#
#---------------------------------------------------------------------------------------------------

dvcs.command		= $(shell which git)
dvcs.revision		= $(shell $(dvcs.command) log -1 --format=%H)
dvcs.branch		= $(shell $(dvcs.command) rev-parse --abbrev-ref HEAD)

#---------------------------------------------------------------------------------------------------
#
# Toggles command verbosity on demand.
#
#---------------------------------------------------------------------------------------------------
ifeq ($(VERBOSE),true)
noecho			=
else
noecho			= @
endif
export noecho

#---------------------------------------------------------------------------------------------------
#
# Base ASCII commands for chaning terminal colors.
#
#---------------------------------------------------------------------------------------------------

colors.success		= \033[32;01m
colors.failure		= \033[31;01m
colors.restore		= \033[0m

#---------------------------------------------------------------------------------------------------
#
# Wrappers for colors.
#
#---------------------------------------------------------------------------------------------------

echo.success		= $(colors.success)$(1)$(colors.restore)
echo.failure		= $(colors.failure)$(1)$(colors.restore)
